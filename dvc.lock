schema: '2.0'
stages:
  data_ingestion:
    cmd: uv run python -m src.data.download_dataset --url 
      https://raw.githubusercontent.com/Himanshu-1703/reddit-sentiment-analysis/refs/heads/main/data/reddit.csv
      --output_path data/raw/reddit_comments.csv
    deps:
    - path: src/data/download_dataset.py
      hash: md5
      md5: 133dd7458c14afa797daee3fead1422e
      size: 3653
    outs:
    - path: data/raw/reddit_comments.csv
      hash: md5
      md5: 38ee083169162dbac0cb07c80ac0f04e
      size: 6888934
  data_preparation:
    cmd: uv run python -m src.data.make_dataset --test_size 0.15 --random_state 
      42
    deps:
    - path: data/raw/reddit_comments.csv
      hash: md5
      md5: 38ee083169162dbac0cb07c80ac0f04e
      size: 6888934
    - path: src/data/make_dataset.py
      hash: md5
      md5: 79c08644605746c0a7bb35da78617599
      size: 5032
    params:
      params.yaml:
        data_preparation.random_state: 42
        data_preparation.test_size: 0.15
    outs:
    - path: data/processed/test.parquet
      hash: md5
      md5: 28b2289497d5ce4f41945ef18ed36b6d
      size: 511597
    - path: data/processed/train.parquet
      hash: md5
      md5: b91b5441e14fbb36b0289251c073ee3c
      size: 2387085
    - path: data/processed/val.parquet
      hash: md5
      md5: 3268ccb60c38c536fb968913be0ba6c1
      size: 497388
  feature_comparison:
    cmd: uv run python -m src.features.tfidf_vs_bert --ngram_ranges 
      [(1,1),(1,2),(1,3)] --max_features 5000 --batch_size 32 --n_estimators 200
      --max_depth 15
    deps:
    - path: data/processed/test.parquet
      hash: md5
      md5: 28b2289497d5ce4f41945ef18ed36b6d
      size: 511597
    - path: data/processed/train.parquet
      hash: md5
      md5: b91b5441e14fbb36b0289251c073ee3c
      size: 2387085
    - path: src/features/tfidf_vs_bert.py
      hash: md5
      md5: 26ea0e0711d9655b13c3fc011d74de6a
      size: 11520
    - path: src/utils/mlflow_utils.py
      hash: md5
      md5: 17327c8e20a565cdf34fb18db35ab8fa
      size: 1711
    params:
      params.yaml:
        feature_comparison.batch_size: 32
        feature_comparison.max_depth: 15
        feature_comparison.max_features: 5000
        feature_comparison.mlflow_uri: http://127.0.0.1:5000
        feature_comparison.n_estimators: 200
        feature_comparison.ngram_ranges: '[(1,1),(1,2),(1,3)]'
    outs:
    - path: models/features/tfidf_vs_bert/
      hash: md5
      md5: f9419c22dabe3121181a3e86f37f8bf5.dir
      size: 20311437
      nfiles: 6
    - path: reports/figures/tfidf_vs_bert/
      hash: md5
      md5: 1cc628dc106ed90ad25ba7c648346cd6.dir
      size: 69166
      nfiles: 3
  feature_tuning:
    cmd: uv run python -m src.features.tfidf_max_features --max_features_values 
      [1000,2000,3000,4000,5000,6000,7000,8000,9000,10000] --ngram_range (1,1) 
      --n_estimators 200 --max_depth 15
    deps:
    - path: data/processed/test.parquet
      hash: md5
      md5: 28b2289497d5ce4f41945ef18ed36b6d
      size: 511597
    - path: data/processed/train.parquet
      hash: md5
      md5: b91b5441e14fbb36b0289251c073ee3c
      size: 2387085
    - path: src/features/tfidf_max_features.py
      hash: md5
      md5: d42e31f1fed325fd8f52542c8374fed5
      size: 8010
    - path: src/utils/mlflow_utils.py
      hash: md5
      md5: 17327c8e20a565cdf34fb18db35ab8fa
      size: 1711
    params:
      params.yaml:
        feature_tuning.max_depth: 15
        feature_tuning.max_features_values: '[1000,2000,3000,4000,5000,6000,7000,8000,9000,10000]'
        feature_tuning.n_estimators: 200
        feature_tuning.ngram_range: (1,1)
    outs:
    - path: models/features/tfidf_max_features/
      hash: md5
      md5: 28900f5d494ac2f55442ce59d657ecd9.dir
      size: 69084492
      nfiles: 20
    - path: reports/figures/tfidf_max_features/
      hash: md5
      md5: 7717470a3c38b233d515582e13843cd0.dir
      size: 251869
      nfiles: 10
